using System.Text;

namespace LogParser.VulnDataUtils;

public readonly struct Exploit
{
    public string RequestType { get; }
    public string Url { get; }
    public string Text { get; }
    public string Parameters { get; }
    public string FuncArgs { get; }

    public Exploit(Dictionary<string, string> dict)
    {
        RequestType = dict[$"{StringConstants.ExploitLiteral}.RequestType"];
        Url = dict[$"{StringConstants.ExploitLiteral}.URL"];
        Text = dict[$"{StringConstants.ExploitLiteral}.Text"];
        Parameters = dict[$"{StringConstants.ExploitLiteral}.Parameters"];
        FuncArgs = dict[$"{StringConstants.ExploitLiteral}.FuncArgs"];
    }

    public override string ToString()
    {
        var stringBuilder = new StringBuilder();
        stringBuilder.AppendLine("\"Exploit\": {");
        stringBuilder.AppendLine($"  \"RequestType\": \"{RequestType}\",");
        stringBuilder.AppendLine($"  \"URL\": \"{Url}\",");
        stringBuilder.AppendLine($"  \"Text\": \"{Text}\",");
        stringBuilder.AppendLine($"  \"Parameters\": {Parameters}");
        stringBuilder.AppendLine($"  \"FuncArgs\": \"{FuncArgs}\",");
        stringBuilder.AppendLine("},");
        return stringBuilder.ToString();
    }
}